"use strict";function restrictNumberToPrefdecimalOnInput(t){var e=$("select#currency_id").find(":selected").data("type");restrictNumberToPrefdecimal(t,e)}function determineDecimalPoint(){var t=$("select#currency_id").find(":selected").data("type");"crypto"==t?($(".pFees, .fFees, .total_fees").text(CRYPTODP),$("#amount").attr("placeholder",CRYPTODP)):"fiat"==t&&($(".pFees, .fFees, .total_fees").text(FIATDP),$("#amount").attr("placeholder",FIATDP))}function isNumber(t){t=t||window.event;var e=t.which?t.which:t.keyCode;return!(e>31&&(e<48||e>57))}if($(".main-containt").find("#depositCreate").length){function activePaymentMethodsList(t){return new Promise((e,n)=>{let a=$('[name="_token"]').val();$.post(paymentMethodListUrl,{_token:a,transaction_type_id:transactionTypeId,currency_id:t}).done(t=>{if(""!=t.success.paymentMethods){let n="";$.map(t.success.paymentMethods,(t,e)=>{n+=`<option value="${t.id}" ${t.id==selectedPaymentMethod?"selected":""}>${t.name}</option>`}),$("#payment_method").html(n),$("#paymentMethodSection").removeClass("d-none"),$("#paymentMethodEmpty").addClass("d-none"),$("#depositCreateSubmitBtn").removeClass("d-none"),checkAmountLimitAndFeesLimit(),e()}else $("#payment_method").val(""),$("#percentage_fee").val(0),$("#fixed_fee").val(0),$("#total_fee").val(0),$(".pFees").html("0"),$(".fFees").html("0"),$(".total_fees").html("0.00"),$("#paymentMethodSection").addClass("d-none"),$("#paymentMethodEmpty").removeClass("d-none"),$("#depositCreateSubmitBtn").addClass("d-none"),e()}).fail(t=>{n(t)})})}var lastCurrencyType,currentCurrencyType;function checkAmountLimitAndFeesLimit(){var t=$('[name="_token"]').val(),e=$("#amount").val().trim(),n=$("#currency_id").val(),a=$("#payment_method option:selected").val();""!=e&&$.post({url:feesLimitUrl,dataType:"json",data:{_token:t,amount:e,currency_id:n,payment_method_id:a,transaction_type_id:transactionTypeId}}).done(function(t){if(200==t.success.status)$("#percentage_fee").val(t.success.feesPercentage),$("#fixed_fee").val(t.success.feesFixed),$("#total_fee").val(t.success.totalFees),$(".total_fees").html(t.success.formattedTotalFees),$(".pFees").html(t.success.formattedFeesPercentage),$(".fFees").html(t.success.formattedFeesFixed),$(".amountLimit").text(""),$("#depositCreateSubmitBtn").attr("disabled",!1);else{if(""!=e)return $(".amountLimit").text(t.success.message),$("#depositCreateSubmitBtn").attr("disabled",!0),!1;$(".amountLimit").text(""),$("#depositCreateSubmitBtn").attr("disabled",!1)}})}$(window).on("load",function(){determineDecimalPoint();var t=$("#currency_id").val();setTimeout(function(){activePaymentMethodsList(t)},300)}),$("select").change(function(){lastCurrencyType="undefined"!==$(this).attr("data-old")?$(this).attr("data-old"):"",currentCurrencyType=$("option:selected",this).data("type"),$(this).attr("data-old",currentCurrencyType)}).change(),$(document).on("change","#currency_id",function(){lastCurrencyType!==currentCurrencyType&&$("#amount").val(""),$(".amount-limit-error").text(""),determineDecimalPoint();var t=$("#currency_id").val();activePaymentMethodsList(t)}),$(document).on("change","#payment_method",function(){checkAmountLimitAndFeesLimit()}),$(document).on("input","#amount",$.debounce(1e3,function(){checkAmountLimitAndFeesLimit()})),$("#depositCreateForm").on("submit",function(){$(".spinner").removeClass("d-none"),$("#rightAngleSvgIcon").addClass("d-none"),$("#depositCreateSubmitBtn").attr("disabled",!0),$("#depositCreateSubmitBtnText").text(submitBtnText)})}if($(".main-containt").find("#depositStripe").length){function makePayment(){var t=new Promise(function(t,e){var n=$("#cardNumber").val().trim(),a=$("#month").val().trim(),o=$("#year").val().trim(),i=$("#cvc").val().trim();$("#stripeError").html(""),n&&a&&o&&i&&$.post({url:stripeMakePaymentUrl,data:{_token:token,cardNumber:n,month:a,year:o,cvc:i},beforeSend:function(t){$("#depositStripeSubmitBtn").attr("disabled",!0)}}).done(function(n){200!=n.data.status?($("#stripeError").html(n.data.message),e(n.data.status)):($("#depositStripeSubmitBtn").attr("disabled",!1),t(n.data))})});return t}function confirmPayment(){makePayment().then(function(t){$.ajax({url:stripeConfirmPaymentUrl,method:"POST",data:{_token:token,paymentIntendId:t.paymentIntendId,paymentMethodId:t.paymentMethodId},dataType:"json",beforeSend:function(t){$("#depositStripeSubmitBtn").attr("disabled",!0)}}).done(function(t){if(200!=t.data.status)return $("#depositStripeSubmitBtn").attr("disabled",!0),$("#stripeError").html(t.data.message),!1;$("#depositStripeSubmitBtn").attr("disabled",!1),window.location.replace(stripeSuccessUrl)}).fail(function(t){$("#depositStripeSubmitBtn").attr("disabled",!0),$("#stripeError").html(errorMessage)})}).catch(function(t){$("#depositStripeSubmitBtn").attr("disabled",!0),$("#stripeError").html(errorMessage)})}$(document).ready(function(){$("#stripePaymentForm").submit(function(t){t.preventDefault(),$("#depositStripeSubmitBtn").attr("disabled",!0),$(".spinner").removeClass("d-none"),$("#rightAngleSvgIcon").addClass("d-none"),$("#depositConfirmBackBtn").removeAttr("href"),$("#depositStripeSubmitBtnText").text(confirmBtnText),confirmPayment()})}),$("#month").on("change",function(){$("#depositStripeSubmitBtn").prop("disabled",!0),makePayment()}),$("#cardNumber, #year, #cvc").on("keyup",$.debounce(1e3,function(){$("#depositStripeSubmitBtn").prop("disabled",!0),makePayment()})),$("#cardNumber").on("input",function(t){var e=t.target,n=e.selectionEnd,a=e.value.length;e.value=e.value.replace(/[^\d]/g,"").replace(/(.{4})/g,"$1 ").trim(),e.selectionEnd=n+=" "===e.value.charAt(n-1)&&" "===e.value.charAt(a-1)&&a!==e.value.length?1:0})}if($(".main-containt").find("#depositPaypal").length&&("undefined"==typeof paypal&&$("#paypal-errors").text(paypalErrorText),paypal.Buttons({createOrder:function(t,e){return e.order.create({purchase_units:[{amount:{value:amount}}]})},onApprove:function(t,e){return e.order.capture().then(function(t){window.location.replace(SITE_URL+"/deposit/paypal-payment/success/"+btoa(t.purchase_units[0].amount.value))})}}).render("#paypal-button-container")),$(".main-containt").find("#depositBank").length){function getBanks(){const t=$("#bank").val();t&&$.post({url:bankDetailsUrl,data:{_token:token,bank:t}}).done(function({status:t,bank:{bank_name:e,account_name:n,account_number:a},bank_logo:o}){if(t){$("#bank_name").html(e),$("#account_name").html(n),$("#account_number").html(a);const t=o?`${bankLogoPath}/${o}`:`${defaultBankLogoPath}`;$("#bank_logo").html(`<img src="${t}" class="img-fluid" width="120" height="80"/>`)}else $("#bank_name, #account_name, #account_number").html("")})}$(window).on("load change",function(){setTimeout(function(){getBanks()},300)}),$("#depositBankForm").on("submit",function(){$("#depositBankSubmitBtn").attr("disabled",!0),$(".spinner").removeClass("d-none"),$("#rightAngleSvgIcon").addClass("d-none"),$("#depositConfirmBackBtn").removeAttr("href"),$("#depositBankSubmitBtnText").text(confirmBtnText)})}$(".main-containt").find("#depositConfirm").length&&$("#depositConfirmForm").on("submit",function(){$("#depositConfirmBtn").attr("disabled",!0),$("#depositConfirmBackBtn").removeAttr("href"),$(".spinner").removeClass("d-none"),$("#rightAngleSvgIcon").addClass("d-none"),$("#depositConfirmBtnText").text(confirmBtnText),setTimeout(function(){$("#depositConfirmBtn").attr("disabled",!1),$(".spinner").addClass("d-none"),$("#rightAngleSvgIcon").addClass("d-none"),$("#depositConfirmBtnText").text(pretext)},300)}),$(".main-containt").find("#depositSuccess").length&&$(document).ready(function(){window.history.pushState(null,"",window.location.href),window.onpopstate=function(){window.history.pushState(null,"",window.location.href)},$(document).on("keydown",function(t){116==(t.which||t.keyCode)&&t.preventDefault()}),$(document).on("keydown",function(t){82==t.keyCode&&t.ctrlKey&&t.preventDefault()})});